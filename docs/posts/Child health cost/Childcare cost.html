<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jayjit Das">

<title>Portfolio - Childcare Cost Prediction using XGBoost and early stopping approach</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Portfolio</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../projects.html" rel="" target="">
 <span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../curriculum vitae.qmd" rel="" target="">
 <span class="menu-text">Curriculum vitae</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.youtube.com/" rel="" target=""><i class="bi bi-youtube" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">Childcare Cost Prediction using XGBoost and early stopping approach</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Jayjit Das </p>
            </div>
    </div>
      
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#goal-predict-the-cost-of-childcare-in-us-counties-based-on-various-characteristics-of-each-county." id="toc-goal-predict-the-cost-of-childcare-in-us-counties-based-on-various-characteristics-of-each-county." class="nav-link active" data-scroll-target="#goal-predict-the-cost-of-childcare-in-us-counties-based-on-various-characteristics-of-each-county.">Goal: Predict the cost of childcare in US counties based on various characteristics of each county.</a>
  <ul class="collapse">
  <li><a href="#exploratory-data-analysis" id="toc-exploratory-data-analysis" class="nav-link" data-scroll-target="#exploratory-data-analysis">Exploratory data analysis</a>
  <ul class="collapse">
  <li><a href="#data-dictionary" id="toc-data-dictionary" class="nav-link" data-scroll-target="#data-dictionary">Data Dictionary</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#childcare_costs.csv" id="toc-childcare_costs.csv" class="nav-link" data-scroll-target="#childcare_costs.csv"><code>childcare_costs.csv</code></a>
  <ul class="collapse">
  <li><a href="#building-a-model" id="toc-building-a-model" class="nav-link" data-scroll-target="#building-a-model">Building a model</a></li>
  <li><a href="#evaluating-results" id="toc-evaluating-results" class="nav-link" data-scroll-target="#evaluating-results">Evaluating results</a></li>
  <li><a href="#deploying-the-model" id="toc-deploying-the-model" class="nav-link" data-scroll-target="#deploying-the-model">Deploying the model</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="goal-predict-the-cost-of-childcare-in-us-counties-based-on-various-characteristics-of-each-county." class="level1">
<h1>Goal: Predict the cost of childcare in US counties based on various characteristics of each county.</h1>
<p>The emphasis of this project is on the utilization of tidymodels framework for the optimization of an xgboost model through <a href="https://en.wikipedia.org/wiki/Early_stopping#:~:text=In%20machine%20learning%2C%20early%20stopping,training%20data%20with%20each%20iteration.">early stopping</a>, employing the current week’s #TidyTuesday <a href="https://github.com/rfordatascience/tidytuesday/tree/master/data/2023/2023-05-09">dataset</a> on childcare expenses in the United States.</p>
<section id="exploratory-data-analysis" class="level2">
<h2 class="anchored" data-anchor-id="exploratory-data-analysis">Exploratory data analysis</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>childcare_costs <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">'https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2023/2023-05-09/childcare_costs.csv'</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(childcare_costs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 34,567
Columns: 61
$ county_fips_code          &lt;dbl&gt; 1001, 1001, 1001, 1001, 1001, 1001, 1001, 10…
$ study_year                &lt;dbl&gt; 2008, 2009, 2010, 2011, 2012, 2013, 2014, 20…
$ unr_16                    &lt;dbl&gt; 5.42, 5.93, 6.21, 7.55, 8.60, 9.39, 8.50, 7.…
$ funr_16                   &lt;dbl&gt; 4.41, 5.72, 5.57, 8.13, 8.88, 10.31, 9.18, 8…
$ munr_16                   &lt;dbl&gt; 6.32, 6.11, 6.78, 7.03, 8.29, 8.56, 7.95, 6.…
$ unr_20to64                &lt;dbl&gt; 4.6, 4.8, 5.1, 6.2, 6.7, 7.3, 6.8, 5.9, 4.4,…
$ funr_20to64               &lt;dbl&gt; 3.5, 4.6, 4.6, 6.3, 6.4, 7.6, 6.8, 6.1, 4.6,…
$ munr_20to64               &lt;dbl&gt; 5.6, 5.0, 5.6, 6.1, 7.0, 7.0, 6.8, 5.9, 4.3,…
$ flfpr_20to64              &lt;dbl&gt; 68.9, 70.8, 71.3, 70.2, 70.6, 70.7, 69.9, 68…
$ flfpr_20to64_under6       &lt;dbl&gt; 66.9, 63.7, 67.0, 66.5, 67.1, 67.5, 65.2, 66…
$ flfpr_20to64_6to17        &lt;dbl&gt; 79.59, 78.41, 78.15, 77.62, 76.31, 75.91, 75…
$ flfpr_20to64_under6_6to17 &lt;dbl&gt; 60.81, 59.91, 59.71, 59.31, 58.30, 58.00, 57…
$ mlfpr_20to64              &lt;dbl&gt; 84.0, 86.2, 85.8, 85.7, 85.7, 85.0, 84.2, 82…
$ pr_f                      &lt;dbl&gt; 8.5, 7.5, 7.5, 7.4, 7.4, 8.3, 9.1, 9.3, 9.4,…
$ pr_p                      &lt;dbl&gt; 11.5, 10.3, 10.6, 10.9, 11.6, 12.1, 12.8, 12…
$ mhi_2018                  &lt;dbl&gt; 58462.55, 60211.71, 61775.80, 60366.88, 5915…
$ me_2018                   &lt;dbl&gt; 32710.60, 34688.16, 34740.84, 34564.32, 3432…
$ fme_2018                  &lt;dbl&gt; 25156.25, 26852.67, 27391.08, 26727.68, 2796…
$ mme_2018                  &lt;dbl&gt; 41436.80, 43865.64, 46155.24, 45333.12, 4427…
$ total_pop                 &lt;dbl&gt; 49744, 49584, 53155, 53944, 54590, 54907, 55…
$ one_race                  &lt;dbl&gt; 98.1, 98.6, 98.5, 98.5, 98.5, 98.6, 98.7, 98…
$ one_race_w                &lt;dbl&gt; 78.9, 79.1, 79.1, 78.9, 78.9, 78.3, 78.0, 77…
$ one_race_b                &lt;dbl&gt; 17.7, 17.9, 17.9, 18.1, 18.1, 18.4, 18.6, 18…
$ one_race_i                &lt;dbl&gt; 0.4, 0.4, 0.3, 0.2, 0.3, 0.3, 0.4, 0.4, 0.4,…
$ one_race_a                &lt;dbl&gt; 0.4, 0.6, 0.7, 0.7, 0.8, 1.0, 0.9, 1.0, 0.8,…
$ one_race_h                &lt;dbl&gt; 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1,…
$ one_race_other            &lt;dbl&gt; 0.7, 0.7, 0.6, 0.5, 0.4, 0.7, 0.7, 0.9, 1.4,…
$ two_races                 &lt;dbl&gt; 1.9, 1.4, 1.5, 1.5, 1.5, 1.4, 1.3, 1.6, 2.0,…
$ hispanic                  &lt;dbl&gt; 1.8, 2.0, 2.3, 2.4, 2.4, 2.5, 2.5, 2.6, 2.6,…
$ households                &lt;dbl&gt; 18373, 18288, 19718, 19998, 19934, 20071, 20…
$ h_under6_both_work        &lt;dbl&gt; 1543, 1475, 1569, 1695, 1714, 1532, 1557, 13…
$ h_under6_f_work           &lt;dbl&gt; 970, 964, 1009, 1060, 938, 880, 1191, 1258, …
$ h_under6_m_work           &lt;dbl&gt; 22, 16, 16, 106, 120, 161, 159, 211, 109, 10…
$ h_under6_single_m         &lt;dbl&gt; 995, 1099, 1110, 1030, 1095, 1160, 954, 883,…
$ h_6to17_both_work         &lt;dbl&gt; 4900, 5028, 5472, 5065, 4608, 4238, 4056, 40…
$ h_6to17_fwork             &lt;dbl&gt; 1308, 1519, 1541, 1965, 1963, 1978, 2073, 20…
$ h_6to17_mwork             &lt;dbl&gt; 114, 92, 113, 246, 284, 354, 373, 551, 322, …
$ h_6to17_single_m          &lt;dbl&gt; 1966, 2305, 2377, 2299, 2644, 2522, 2269, 21…
$ emp_m                     &lt;dbl&gt; 27.40, 29.54, 29.33, 31.17, 32.13, 31.74, 32…
$ memp_m                    &lt;dbl&gt; 24.41, 26.07, 25.94, 26.97, 28.59, 27.44, 28…
$ femp_m                    &lt;dbl&gt; 30.68, 33.40, 33.06, 35.96, 36.09, 36.61, 37…
$ emp_service               &lt;dbl&gt; 17.06, 15.81, 16.92, 16.18, 16.09, 16.72, 16…
$ memp_service              &lt;dbl&gt; 15.53, 14.16, 15.09, 14.21, 14.71, 13.92, 13…
$ femp_service              &lt;dbl&gt; 18.75, 17.64, 18.93, 18.42, 17.63, 19.89, 20…
$ emp_sales                 &lt;dbl&gt; 29.11, 28.75, 29.07, 27.56, 28.39, 27.22, 25…
$ memp_sales                &lt;dbl&gt; 15.97, 17.51, 17.82, 17.74, 17.79, 17.38, 15…
$ femp_sales                &lt;dbl&gt; 43.52, 41.25, 41.43, 38.76, 40.26, 38.36, 36…
$ emp_n                     &lt;dbl&gt; 13.21, 11.89, 11.57, 10.72, 9.02, 9.27, 9.38…
$ memp_n                    &lt;dbl&gt; 22.54, 20.30, 19.86, 18.28, 16.03, 16.79, 17…
$ femp_n                    &lt;dbl&gt; 2.99, 2.52, 2.45, 2.09, 1.19, 0.77, 0.58, 0.…
$ emp_p                     &lt;dbl&gt; 13.22, 14.02, 13.11, 14.38, 14.37, 15.04, 16…
$ memp_p                    &lt;dbl&gt; 21.55, 21.96, 21.28, 22.80, 22.88, 24.48, 24…
$ femp_p                    &lt;dbl&gt; 4.07, 5.19, 4.13, 4.77, 4.84, 4.36, 6.07, 7.…
$ mcsa                      &lt;dbl&gt; 80.92, 83.42, 85.92, 88.43, 90.93, 93.43, 95…
$ mfccsa                    &lt;dbl&gt; 81.40, 85.68, 89.96, 94.25, 98.53, 102.82, 1…
$ mc_infant                 &lt;dbl&gt; 104.95, 105.11, 105.28, 105.45, 105.61, 105.…
$ mc_toddler                &lt;dbl&gt; 104.95, 105.11, 105.28, 105.45, 105.61, 105.…
$ mc_preschool              &lt;dbl&gt; 85.92, 87.59, 89.26, 90.93, 92.60, 94.27, 95…
$ mfcc_infant               &lt;dbl&gt; 83.45, 87.39, 91.33, 95.28, 99.22, 103.16, 1…
$ mfcc_toddler              &lt;dbl&gt; 83.45, 87.39, 91.33, 95.28, 99.22, 103.16, 1…
$ mfcc_preschool            &lt;dbl&gt; 81.40, 85.68, 89.96, 94.25, 98.53, 102.82, 1…</code></pre>
</div>
</div>
<section id="data-dictionary" class="level3">
<h3 class="anchored" data-anchor-id="data-dictionary">Data Dictionary</h3>
</section>
</section>
</section>
<section id="childcare_costs.csv" class="level1">
<h1><code>childcare_costs.csv</code></h1>
<table class="table">
<colgroup>
<col style="width: 10%">
<col style="width: 3%">
<col style="width: 86%">
</colgroup>
<thead>
<tr class="header">
<th>variable</th>
<th>class</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>county_fips_code</td>
<td>double</td>
<td>Four- or five-digit number that uniquely identifies the county in a state. The first two digits (for five-digit numbers) or 1 digit (for four-digit numbers) refer to the FIPS code of the state to which the county belongs.</td>
</tr>
<tr class="even">
<td>study_year</td>
<td>double</td>
<td>Year the data collection began for the market rate survey and in which ACS data is representative of, or the study publication date.</td>
</tr>
<tr class="odd">
<td>unr_16</td>
<td>double</td>
<td>Unemployment rate of the population aged 16 years old or older.</td>
</tr>
<tr class="even">
<td>funr_16</td>
<td>double</td>
<td>Unemployment rate of the female population aged 16 years old or older.</td>
</tr>
<tr class="odd">
<td>munr_16</td>
<td>double</td>
<td>Unemployment rate of the male population aged 16 years old or older.</td>
</tr>
<tr class="even">
<td>unr_20to64</td>
<td>double</td>
<td>Unemployment rate of the population aged 20 to 64 years old.</td>
</tr>
<tr class="odd">
<td>funr_20to64</td>
<td>double</td>
<td>Unemployment rate of the female population aged 20 to 64 years old.</td>
</tr>
<tr class="even">
<td>munr_20to64</td>
<td>double</td>
<td>Unemployment rate of the male population aged 20 to 64 years old.</td>
</tr>
<tr class="odd">
<td>flfpr_20to64</td>
<td>double</td>
<td>Labor force participation rate of the female population aged 20 to 64 years old.</td>
</tr>
<tr class="even">
<td>flfpr_20to64_under6</td>
<td>double</td>
<td>Labor force participation rate of the female population aged 20 to 64 years old who have children under 6 years old.</td>
</tr>
<tr class="odd">
<td>flfpr_20to64_6to17</td>
<td>double</td>
<td>Labor force participation rate of the female population aged 20 to 64 years old who have children between 6 and 17 years old.</td>
</tr>
<tr class="even">
<td>flfpr_20to64_under6_6to17</td>
<td>double</td>
<td>Labor force participation rate of the female population aged 20 to 64 years old who have children under 6 years old and between 6 and 17 years old.</td>
</tr>
<tr class="odd">
<td>mlfpr_20to64</td>
<td>double</td>
<td>Labor force participation rate of the male population aged 20 to 64 years old.</td>
</tr>
<tr class="even">
<td>pr_f</td>
<td>double</td>
<td>Poverty rate for families.</td>
</tr>
<tr class="odd">
<td>pr_p</td>
<td>double</td>
<td>Poverty rate for individuals.</td>
</tr>
<tr class="even">
<td>mhi_2018</td>
<td>double</td>
<td>Median household income expressed in 2018 dollars.</td>
</tr>
<tr class="odd">
<td>me_2018</td>
<td>double</td>
<td>Median earnings expressed in 2018 dollars for the population aged 16 years old or older.</td>
</tr>
<tr class="even">
<td>fme_2018</td>
<td>double</td>
<td>Median earnings for females expressed in 2018 dollars for the population aged 16 years old or older.</td>
</tr>
<tr class="odd">
<td>mme_2018</td>
<td>double</td>
<td>Median earnings for males expressed in 2018 dollars for the population aged 16 years old or older.</td>
</tr>
<tr class="even">
<td>total_pop</td>
<td>double</td>
<td>Count of the total population.</td>
</tr>
<tr class="odd">
<td>one_race</td>
<td>double</td>
<td>Percent of population that identifies as being one race.</td>
</tr>
<tr class="even">
<td>one_race_w</td>
<td>double</td>
<td>Percent of population that identifies as being one race and being only White or Caucasian.</td>
</tr>
<tr class="odd">
<td>one_race_b</td>
<td>double</td>
<td>Percent of population that identifies as being one race and being only Black or African American.</td>
</tr>
<tr class="even">
<td>one_race_i</td>
<td>double</td>
<td>Percent of population that identifies as being one race and being only American Indian or Alaska Native.</td>
</tr>
<tr class="odd">
<td>one_race_a</td>
<td>double</td>
<td>Percent of population that identifies as being one race and being only Asian.</td>
</tr>
<tr class="even">
<td>one_race_h</td>
<td>double</td>
<td>Percent of population that identifies as being one race and being only Native Hawaiian or Pacific Islander.</td>
</tr>
<tr class="odd">
<td>one_race_other</td>
<td>double</td>
<td>Percent of population that identifies as being one race and being a different race not previously mentioned.</td>
</tr>
<tr class="even">
<td>two_races</td>
<td>double</td>
<td>Percent of population that identifies as being two or more races.</td>
</tr>
<tr class="odd">
<td>hispanic</td>
<td>double</td>
<td>Percent of population that identifies as being Hispanic or Latino regardless of race.</td>
</tr>
<tr class="even">
<td>households</td>
<td>double</td>
<td>Number of households.</td>
</tr>
<tr class="odd">
<td>h_under6_both_work</td>
<td>double</td>
<td>Number of households with children under 6 years old with two parents that are both working.</td>
</tr>
<tr class="even">
<td>h_under6_f_work</td>
<td>double</td>
<td>Number of households with children under 6 years old with two parents with only the father working.</td>
</tr>
<tr class="odd">
<td>h_under6_m_work</td>
<td>double</td>
<td>Number of households with children under 6 years old with two parents with only the mother working.</td>
</tr>
<tr class="even">
<td>h_under6_single_m</td>
<td>double</td>
<td>Number of households with children under 6 years old with a single mother.</td>
</tr>
<tr class="odd">
<td>h_6to17_both_work</td>
<td>double</td>
<td>Number of households with children between 6 and 17 years old with two parents that are both working.</td>
</tr>
<tr class="even">
<td>h_6to17_fwork</td>
<td>double</td>
<td>Number of households with children between 6 and 17 years old with two parents with only the father working.</td>
</tr>
<tr class="odd">
<td>h_6to17_mwork</td>
<td>double</td>
<td>Number of households with children between 6 and 17 years old with two parents with only the mother working.</td>
</tr>
<tr class="even">
<td>h_6to17_single_m</td>
<td>double</td>
<td>Number of households with children between 6 and 17 years old with a single mother.</td>
</tr>
<tr class="odd">
<td>emp_m</td>
<td>double</td>
<td>Percent of civilians employed in management, business, science, and arts occupations aged 16 years old or older in the county.</td>
</tr>
<tr class="even">
<td>memp_m</td>
<td>double</td>
<td>Percent of male civilians employed in management, business, science, and arts occupations aged 16 years old or older in the county.</td>
</tr>
<tr class="odd">
<td>femp_m</td>
<td>double</td>
<td>Percent of female civilians employed in management, business, science, and arts occupations aged 16 years old or older in the county.</td>
</tr>
<tr class="even">
<td>emp_service</td>
<td>double</td>
<td>Percent of civilians employed in service occupations aged 16 years old and older in the county.</td>
</tr>
<tr class="odd">
<td>memp_service</td>
<td>double</td>
<td>Percent of male civilians employed in service occupations aged 16 years old and older in the county.</td>
</tr>
<tr class="even">
<td>femp_service</td>
<td>double</td>
<td>Percent of female civilians employed in service occupations aged 16 years old and older in the county.</td>
</tr>
<tr class="odd">
<td>emp_sales</td>
<td>double</td>
<td>Percent of civilians employed in sales and office occupations aged 16 years old and older in the county.</td>
</tr>
<tr class="even">
<td>memp_sales</td>
<td>double</td>
<td>Percent of male civilians employed in sales and office occupations aged 16 years old and older in the county.</td>
</tr>
<tr class="odd">
<td>femp_sales</td>
<td>double</td>
<td>Percent of female civilians employed in sales and office occupations aged 16 years old and older in the county.</td>
</tr>
<tr class="even">
<td>emp_n</td>
<td>double</td>
<td>Percent of civilians employed in natural resources, construction, and maintenance occupations aged 16 years old and older in the county.</td>
</tr>
<tr class="odd">
<td>memp_n</td>
<td>double</td>
<td>Percent of male civilians employed in natural resources, construction, and maintenance occupations aged 16 years old and older in the county.</td>
</tr>
<tr class="even">
<td>femp_n</td>
<td>double</td>
<td>Percent of female civilians employed in natural resources, construction, and maintenance occupations aged 16 years old and older in the county.</td>
</tr>
<tr class="odd">
<td>emp_p</td>
<td>double</td>
<td>Percent of civilians employed in production, transportation, and material moving occupations aged 16 years old and older in the county.</td>
</tr>
<tr class="even">
<td>memp_p</td>
<td>double</td>
<td>Percent of male civilians employed in production, transportation, and material moving occupations aged 16 years old and older in the county.</td>
</tr>
<tr class="odd">
<td>femp_p</td>
<td>double</td>
<td>Percent of female civilians employed in production, transportation, and material moving occupations aged 16 years old and older in the county.</td>
</tr>
<tr class="even">
<td>mcsa</td>
<td>double</td>
<td>Weekly, full-time median price charged for Center-Based Care for those who are school age based on the results reported in the market rate survey report for the county or the rate zone/cluster to which the county is assigned.</td>
</tr>
<tr class="odd">
<td>mfccs</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>In this dataset, there are numerous variables that could potentially serve as predictors. When dealing with large datasets with many variables, some of which are strongly correlated, I frequently use xgboost as a modeling algorithm due to its effectiveness.</p>
<p>Before we proceed with the modeling, it’s beneficial to conduct some exploratory data analysis. Specifically, we’re interested in understanding how the <strong>mcsa</strong> (the median weekly cost for school-aged children in childcare centers) has evolved over time.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the lower and upper bounds for outliers</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>childcare_costs <span class="sc">|&gt;</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(study_year, mcsa, <span class="at">group =</span> study_year, <span class="at">fill =</span> study_year)) <span class="sc">+</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">"Blues"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Childcare-cost_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Let us visualize how are childcare costs related to&nbsp;<code>mhi_2018</code>&nbsp;(median household income) and&nbsp;<code>flfpr_20to64</code>&nbsp;(labor force participation for women).</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>childcare_costs <span class="sc">|&gt;</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(mhi_2018, mcsa, <span class="at">color =</span> flfpr_20to64)) <span class="sc">+</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_color_distiller</span>(<span class="at">palette =</span> <span class="st">"Spectral"</span>)<span class="sc">+</span> <span class="fu">theme_minimal</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Childcare-cost_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In counties with lower income levels, the cost of childcare is observed to be relatively stable, while in counties with higher income levels, an escalation in childcare costs is noted. Furthermore, a higher prevalence of women participating in the workforce is seen in high-income counties.</p>
<p>Let’s check the racial composition of these counties.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>childcare_costs <span class="sc">|&gt;</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(mcsa, <span class="fu">starts_with</span>(<span class="st">"one_race"</span>), mhi_2018) <span class="sc">|&gt;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>one_race) <span class="sc">|&gt;</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">starts_with</span>(<span class="st">"one_race"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(value, mcsa, <span class="at">color =</span> mhi_2018)) <span class="sc">+</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(name), <span class="at">scales =</span> <span class="st">"free_x"</span>) <span class="sc">+</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_distiller</span>(<span class="at">palette =</span> <span class="st">"Spectral"</span>)<span class="sc">+</span> <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"% of population"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Childcare-cost_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In counties with a higher Black population (one_race_b), it is observed that both household income and childcare costs are lower. Conversely, in counties with a higher White population (one_race_w), both household income and childcare costs are seen to be higher. A trend appears to exist in counties with a higher Asian population (one_race_a), where an increase in the Asian population is associated with higher childcare costs. It is important to note that these relationships are not causal, but rather, they are indicative of the intricate interplay between race, socioeconomic class, and geographical location in the U.S.</p>
<section id="building-a-model" class="level2">
<h2 class="anchored" data-anchor-id="building-a-model">Building a model</h2>
<p>The initiation of our modeling process involves the establishment of our “data budget.” In this instance, the prediction target is mcsa (the costs associated with school-age children in childcare centers), necessitating the removal of other childcare cost measures related to babies, toddlers, and family-based childcare, among others. The FIPS codes, which explicitly encode location, are also to be removed, shifting the focus to county characteristics such as household income and the number of households with children. Given the substantial size of this dataset, it is <a href="https://www.tmwr.org/resampling.html#validation">suggested</a> that a single validation set be utilized.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">111</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>childcare_split <span class="ot">&lt;-</span> childcare_costs <span class="sc">|&gt;</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">matches</span>(<span class="st">"^mc_|^mfc"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>county_fips_code) <span class="sc">|&gt;</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">|&gt;</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">initial_split</span>(<span class="at">strata =</span> mcsa)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>childcare_train <span class="ot">&lt;-</span> <span class="fu">training</span>(childcare_split)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>childcare_test <span class="ot">&lt;-</span> <span class="fu">testing</span>(childcare_split)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">222</span>)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>childcare_set <span class="ot">&lt;-</span> <span class="fu">validation_split</span>(childcare_train)</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>childcare_set</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Validation Set Split (0.75/0.25)  
# A tibble: 1 × 2
  splits               id        
  &lt;list&gt;               &lt;chr&gt;     
1 &lt;split [13269/4424]&gt; validation</code></pre>
</div>
</div>
<p>Given that all predictors are already in numeric form, there is no requirement for any special feature engineering; a formula such as mcsa ~ … can be utilized. However, there is a need to establish a tunable xgboost model specification with <a href="https://www.geeksforgeeks.org/regularization-by-early-stopping/">early stopping</a>. The number of trees will be maintained as a constant (and not excessively high), the stop_iter (the early stopping parameter) will be set to tune(), and a few other parameters will be tuned. It should be noted that a validation set needs to be established (which in this case is a proportion of the training set) to be reserved for determining when to stop.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>xgb_spec <span class="ot">&lt;-</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">boost_tree</span>(</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">trees =</span> <span class="dv">500</span>,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_n =</span> <span class="fu">tune</span>(),</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">mtry =</span> <span class="fu">tune</span>(),</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">stop_iter =</span> <span class="fu">tune</span>(),</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">learn_rate =</span> <span class="fl">0.01</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"xgboost"</span>, <span class="at">validation =</span> <span class="fl">0.2</span>) <span class="sc">|&gt;</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"regression"</span>)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>xgb_wf <span class="ot">&lt;-</span> <span class="fu">workflow</span>(mcsa <span class="sc">~</span> ., xgb_spec)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>xgb_wf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>══ Workflow ════════════════════════════════════════════════════════════════════
Preprocessor: Formula
Model: boost_tree()

── Preprocessor ────────────────────────────────────────────────────────────────
mcsa ~ .

── Model ───────────────────────────────────────────────────────────────────────
Boosted Tree Model Specification (regression)

Main Arguments:
  mtry = tune()
  trees = 500
  min_n = tune()
  learn_rate = 0.01
  stop_iter = tune()

Engine-Specific Arguments:
  validation = 0.2

Computational engine: xgboost </code></pre>
</div>
</div>
<p>The model is prepared for deployment. The next step involves adjusting various hyperparameters using the training set, which includes a subset reserved for early stopping, in addition to our validation set.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>doParallel<span class="sc">::</span><span class="fu">registerDoParallel</span>()</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">234</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>xgb_rs <span class="ot">&lt;-</span> <span class="fu">tune_grid</span>(xgb_wf, childcare_set, <span class="at">grid =</span> <span class="dv">15</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>xgb_rs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Tuning results
# Validation Set Split (0.75/0.25)  
# A tibble: 1 × 4
  splits               id         .metrics          .notes          
  &lt;list&gt;               &lt;chr&gt;      &lt;list&gt;            &lt;list&gt;          
1 &lt;split [13269/4424]&gt; validation &lt;tibble [30 × 7]&gt; &lt;tibble [0 × 3]&gt;</code></pre>
</div>
</div>
</section>
<section id="evaluating-results" class="level2">
<h2 class="anchored" data-anchor-id="evaluating-results">Evaluating results</h2>
<p>Let’s see how this turned out.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(xgb_rs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Childcare-cost_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Visualizing the top results</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">show_best</span>(xgb_rs, <span class="st">"rmse"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 9
   mtry min_n stop_iter .metric .estimator  mean     n std_err .config          
  &lt;int&gt; &lt;int&gt;     &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;            
1    42     5        14 rmse    standard    21.7     1      NA Preprocessor1_Mo…
2    35     2         9 rmse    standard    21.8     1      NA Preprocessor1_Mo…
3    38     7        20 rmse    standard    21.8     1      NA Preprocessor1_Mo…
4    41    17        16 rmse    standard    21.9     1      NA Preprocessor1_Mo…
5    25    17         8 rmse    standard    21.9     1      NA Preprocessor1_Mo…</code></pre>
</div>
</div>
<p>The optimal Root Mean Square Error (RMSE) is slightly over $20. This value provides an estimate of the accuracy with which we can predict the median childcare cost in a US county, given that the median cost in this dataset was approximately $100.</p>
<p>We will now employ the <strong><code>last_fit()</code></strong> function to fit the model one last time using the training data and evaluate its performance on the test data, utilizing the numerically optimal result obtained from <strong><code>xgb_rs</code></strong>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>childcare_fit <span class="ot">&lt;-</span> xgb_wf <span class="sc">|&gt;</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">finalize_workflow</span>(<span class="fu">select_best</span>(xgb_rs, <span class="st">"rmse"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">last_fit</span>(childcare_split)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>childcare_fit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Resampling results
# Manual resampling 
# A tibble: 1 × 6
  splits               id              .metrics .notes   .predictions .workflow 
  &lt;list&gt;               &lt;chr&gt;           &lt;list&gt;   &lt;list&gt;   &lt;list&gt;       &lt;list&gt;    
1 &lt;split [17693/5900]&gt; train/test spl… &lt;tibble&gt; &lt;tibble&gt; &lt;tibble&gt;     &lt;workflow&gt;</code></pre>
</div>
</div>
<p>Let’s see how did this model perform on the testing data, that was not used in tuning or training.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">collect_metrics</span>(childcare_fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  .metric .estimator .estimate .config             
  &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;               
1 rmse    standard      21.4   Preprocessor1_Model1
2 rsq     standard       0.621 Preprocessor1_Model1</code></pre>
</div>
</div>
<p>Most important features for the target variable in this xgboost model.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vip)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">extract_workflow</span>(childcare_fit) <span class="sc">|&gt;</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_fit_parsnip</span>() <span class="sc">|&gt;</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">vip</span>(<span class="at">num_features =</span> <span class="dv">15</span>, <span class="at">geom =</span> <span class="st">"point"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Childcare-cost_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In this model, significant influences are exerted by the percentage of the county’s population identified as Asian, the median income of households, the median earnings for women, the year, and the total number of households in the county.</p>
</section>
<section id="deploying-the-model" class="level2">
<h2 class="anchored" data-anchor-id="deploying-the-model">Deploying the model</h2>
<p>Object created for deploying the model.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vetiver)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">extract_workflow</span>(childcare_fit) <span class="sc">|&gt;</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">vetiver_model</span>(<span class="st">"childcare-costs-xgb"</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>v</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
── childcare-costs-xgb ─ &lt;bundled_workflow&gt; model for deployment 
A xgboost regression modeling workflow using 52 features</code></pre>
</div>
</div>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb22" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Childcare Cost Prediction using XGBoost and early stopping approach"</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> Jayjit Das</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="an">code-fold:</span><span class="co"> true</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="an">code-tools:</span><span class="co"> true</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="co">    warning: false</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="fu"># Goal: Predict the cost of childcare in US counties based on various characteristics of each county.</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>The emphasis of this project is on the utilization of tidymodels framework for the optimization of an xgboost model through <span class="co">[</span><span class="ot">early stopping</span><span class="co">](https://en.wikipedia.org/wiki/Early_stopping#:~:text=In%20machine%20learning%2C%20early%20stopping,training%20data%20with%20each%20iteration.)</span>, employing the current week’s #TidyTuesday <span class="co">[</span><span class="ot">dataset</span><span class="co">](https://github.com/rfordatascience/tidytuesday/tree/master/data/2023/2023-05-09)</span> on childcare expenses in the United States.</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exploratory data analysis</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>childcare_costs <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">'https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2023/2023-05-09/childcare_costs.csv'</span>)</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(childcare_costs)</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a><span class="fu">### Data Dictionary</span></span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a><span class="fu"># `childcare_costs.csv`</span></span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>| variable                  | class  | description                                                                                                                                                                                                                       |</span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>|---------------------------|--------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|</span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a>| county_fips_code          | double | Four- or five-digit number that uniquely identifies the county in a state. The first two digits (for five-digit numbers) or 1 digit (for four-digit numbers) refer to the FIPS code of the state to which the county belongs.     |</span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a>| study_year                | double | Year the data collection began for the market rate survey and in which ACS data is representative of, or the study publication date.                                                                                              |</span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a>| unr_16                    | double | Unemployment rate of the population aged 16 years old or older.                                                                                                                                                                   |</span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a>| funr_16                   | double | Unemployment rate of the female population aged 16 years old or older.                                                                                                                                                            |</span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a>| munr_16                   | double | Unemployment rate of the male population aged 16 years old or older.                                                                                                                                                              |</span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a>| unr_20to64                | double | Unemployment rate of the population aged 20 to 64 years old.                                                                                                                                                                      |</span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a>| funr_20to64               | double | Unemployment rate of the female population aged 20 to 64 years old.                                                                                                                                                               |</span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a>| munr_20to64               | double | Unemployment rate of the male population aged 20 to 64 years old.                                                                                                                                                                 |</span>
<span id="cb22-45"><a href="#cb22-45" aria-hidden="true" tabindex="-1"></a>| flfpr_20to64              | double | Labor force participation rate of the female population aged 20 to 64 years old.                                                                                                                                                  |</span>
<span id="cb22-46"><a href="#cb22-46" aria-hidden="true" tabindex="-1"></a>| flfpr_20to64_under6       | double | Labor force participation rate of the female population aged 20 to 64 years old who have children under 6 years old.                                                                                                              |</span>
<span id="cb22-47"><a href="#cb22-47" aria-hidden="true" tabindex="-1"></a>| flfpr_20to64_6to17        | double | Labor force participation rate of the female population aged 20 to 64 years old who have children between 6 and 17 years old.                                                                                                     |</span>
<span id="cb22-48"><a href="#cb22-48" aria-hidden="true" tabindex="-1"></a>| flfpr_20to64_under6_6to17 | double | Labor force participation rate of the female population aged 20 to 64 years old who have children under 6 years old and between 6 and 17 years old.                                                                               |</span>
<span id="cb22-49"><a href="#cb22-49" aria-hidden="true" tabindex="-1"></a>| mlfpr_20to64              | double | Labor force participation rate of the male population aged 20 to 64 years old.                                                                                                                                                    |</span>
<span id="cb22-50"><a href="#cb22-50" aria-hidden="true" tabindex="-1"></a>| pr_f                      | double | Poverty rate for families.                                                                                                                                                                                                        |</span>
<span id="cb22-51"><a href="#cb22-51" aria-hidden="true" tabindex="-1"></a>| pr_p                      | double | Poverty rate for individuals.                                                                                                                                                                                                     |</span>
<span id="cb22-52"><a href="#cb22-52" aria-hidden="true" tabindex="-1"></a>| mhi_2018                  | double | Median household income expressed in 2018 dollars.                                                                                                                                                                                |</span>
<span id="cb22-53"><a href="#cb22-53" aria-hidden="true" tabindex="-1"></a>| me_2018                   | double | Median earnings expressed in 2018 dollars for the population aged 16 years old or older.                                                                                                                                          |</span>
<span id="cb22-54"><a href="#cb22-54" aria-hidden="true" tabindex="-1"></a>| fme_2018                  | double | Median earnings for females expressed in 2018 dollars for the population aged 16 years old or older.                                                                                                                              |</span>
<span id="cb22-55"><a href="#cb22-55" aria-hidden="true" tabindex="-1"></a>| mme_2018                  | double | Median earnings for males expressed in 2018 dollars for the population aged 16 years old or older.                                                                                                                                |</span>
<span id="cb22-56"><a href="#cb22-56" aria-hidden="true" tabindex="-1"></a>| total_pop                 | double | Count of the total population.                                                                                                                                                                                                    |</span>
<span id="cb22-57"><a href="#cb22-57" aria-hidden="true" tabindex="-1"></a>| one_race                  | double | Percent of population that identifies as being one race.                                                                                                                                                                          |</span>
<span id="cb22-58"><a href="#cb22-58" aria-hidden="true" tabindex="-1"></a>| one_race_w                | double | Percent of population that identifies as being one race and being only White or Caucasian.                                                                                                                                        |</span>
<span id="cb22-59"><a href="#cb22-59" aria-hidden="true" tabindex="-1"></a>| one_race_b                | double | Percent of population that identifies as being one race and being only Black or African American.                                                                                                                                 |</span>
<span id="cb22-60"><a href="#cb22-60" aria-hidden="true" tabindex="-1"></a>| one_race_i                | double | Percent of population that identifies as being one race and being only American Indian or Alaska Native.                                                                                                                          |</span>
<span id="cb22-61"><a href="#cb22-61" aria-hidden="true" tabindex="-1"></a>| one_race_a                | double | Percent of population that identifies as being one race and being only Asian.                                                                                                                                                     |</span>
<span id="cb22-62"><a href="#cb22-62" aria-hidden="true" tabindex="-1"></a>| one_race_h                | double | Percent of population that identifies as being one race and being only Native Hawaiian or Pacific Islander.                                                                                                                       |</span>
<span id="cb22-63"><a href="#cb22-63" aria-hidden="true" tabindex="-1"></a>| one_race_other            | double | Percent of population that identifies as being one race and being a different race not previously mentioned.                                                                                                                      |</span>
<span id="cb22-64"><a href="#cb22-64" aria-hidden="true" tabindex="-1"></a>| two_races                 | double | Percent of population that identifies as being two or more races.                                                                                                                                                                 |</span>
<span id="cb22-65"><a href="#cb22-65" aria-hidden="true" tabindex="-1"></a>| hispanic                  | double | Percent of population that identifies as being Hispanic or Latino regardless of race.                                                                                                                                             |</span>
<span id="cb22-66"><a href="#cb22-66" aria-hidden="true" tabindex="-1"></a>| households                | double | Number of households.                                                                                                                                                                                                             |</span>
<span id="cb22-67"><a href="#cb22-67" aria-hidden="true" tabindex="-1"></a>| h_under6_both_work        | double | Number of households with children under 6 years old with two parents that are both working.                                                                                                                                      |</span>
<span id="cb22-68"><a href="#cb22-68" aria-hidden="true" tabindex="-1"></a>| h_under6_f_work           | double | Number of households with children under 6 years old with two parents with only the father working.                                                                                                                               |</span>
<span id="cb22-69"><a href="#cb22-69" aria-hidden="true" tabindex="-1"></a>| h_under6_m_work           | double | Number of households with children under 6 years old with two parents with only the mother working.                                                                                                                               |</span>
<span id="cb22-70"><a href="#cb22-70" aria-hidden="true" tabindex="-1"></a>| h_under6_single_m         | double | Number of households with children under 6 years old with a single mother.                                                                                                                                                        |</span>
<span id="cb22-71"><a href="#cb22-71" aria-hidden="true" tabindex="-1"></a>| h_6to17_both_work         | double | Number of households with children between 6 and 17 years old with two parents that are both working.                                                                                                                             |</span>
<span id="cb22-72"><a href="#cb22-72" aria-hidden="true" tabindex="-1"></a>| h_6to17_fwork             | double | Number of households with children between 6 and 17 years old with two parents with only the father working.                                                                                                                      |</span>
<span id="cb22-73"><a href="#cb22-73" aria-hidden="true" tabindex="-1"></a>| h_6to17_mwork             | double | Number of households with children between 6 and 17 years old with two parents with only the mother working.                                                                                                                      |</span>
<span id="cb22-74"><a href="#cb22-74" aria-hidden="true" tabindex="-1"></a>| h_6to17_single_m          | double | Number of households with children between 6 and 17 years old with a single mother.                                                                                                                                               |</span>
<span id="cb22-75"><a href="#cb22-75" aria-hidden="true" tabindex="-1"></a>| emp_m                     | double | Percent of civilians employed in management, business, science, and arts occupations aged 16 years old or older in the county.                                                                                                    |</span>
<span id="cb22-76"><a href="#cb22-76" aria-hidden="true" tabindex="-1"></a>| memp_m                    | double | Percent of male civilians employed in management, business, science, and arts occupations aged 16 years old or older in the county.                                                                                               |</span>
<span id="cb22-77"><a href="#cb22-77" aria-hidden="true" tabindex="-1"></a>| femp_m                    | double | Percent of female civilians employed in management, business, science, and arts occupations aged 16 years old or older in the county.                                                                                             |</span>
<span id="cb22-78"><a href="#cb22-78" aria-hidden="true" tabindex="-1"></a>| emp_service               | double | Percent of civilians employed in service occupations aged 16 years old and older in the county.                                                                                                                                   |</span>
<span id="cb22-79"><a href="#cb22-79" aria-hidden="true" tabindex="-1"></a>| memp_service              | double | Percent of male civilians employed in service occupations aged 16 years old and older in the county.                                                                                                                              |</span>
<span id="cb22-80"><a href="#cb22-80" aria-hidden="true" tabindex="-1"></a>| femp_service              | double | Percent of female civilians employed in service occupations aged 16 years old and older in the county.                                                                                                                            |</span>
<span id="cb22-81"><a href="#cb22-81" aria-hidden="true" tabindex="-1"></a>| emp_sales                 | double | Percent of civilians employed in sales and office occupations aged 16 years old and older in the county.                                                                                                                          |</span>
<span id="cb22-82"><a href="#cb22-82" aria-hidden="true" tabindex="-1"></a>| memp_sales                | double | Percent of male civilians employed in sales and office occupations aged 16 years old and older in the county.                                                                                                                     |</span>
<span id="cb22-83"><a href="#cb22-83" aria-hidden="true" tabindex="-1"></a>| femp_sales                | double | Percent of female civilians employed in sales and office occupations aged 16 years old and older in the county.                                                                                                                   |</span>
<span id="cb22-84"><a href="#cb22-84" aria-hidden="true" tabindex="-1"></a>| emp_n                     | double | Percent of civilians employed in natural resources, construction, and maintenance occupations aged 16 years old and older in the county.                                                                                          |</span>
<span id="cb22-85"><a href="#cb22-85" aria-hidden="true" tabindex="-1"></a>| memp_n                    | double | Percent of male civilians employed in natural resources, construction, and maintenance occupations aged 16 years old and older in the county.                                                                                     |</span>
<span id="cb22-86"><a href="#cb22-86" aria-hidden="true" tabindex="-1"></a>| femp_n                    | double | Percent of female civilians employed in natural resources, construction, and maintenance occupations aged 16 years old and older in the county.                                                                                   |</span>
<span id="cb22-87"><a href="#cb22-87" aria-hidden="true" tabindex="-1"></a>| emp_p                     | double | Percent of civilians employed in production, transportation, and material moving occupations aged 16 years old and older in the county.                                                                                           |</span>
<span id="cb22-88"><a href="#cb22-88" aria-hidden="true" tabindex="-1"></a>| memp_p                    | double | Percent of male civilians employed in production, transportation, and material moving occupations aged 16 years old and older in the county.                                                                                      |</span>
<span id="cb22-89"><a href="#cb22-89" aria-hidden="true" tabindex="-1"></a>| femp_p                    | double | Percent of female civilians employed in production, transportation, and material moving occupations aged 16 years old and older in the county.                                                                                    |</span>
<span id="cb22-90"><a href="#cb22-90" aria-hidden="true" tabindex="-1"></a>| mcsa                      | double | Weekly, full-time median price charged for Center-Based Care for those who are school age based on the results reported in the market rate survey report for the county or the rate zone/cluster to which the county is assigned. |</span>
<span id="cb22-91"><a href="#cb22-91" aria-hidden="true" tabindex="-1"></a>| mfccs                     |        |                                                                                                                                                                                                                                   |</span>
<span id="cb22-92"><a href="#cb22-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-93"><a href="#cb22-93" aria-hidden="true" tabindex="-1"></a>In this dataset, there are numerous variables that could potentially serve as predictors. When dealing with large datasets with many variables, some of which are strongly correlated, I frequently use xgboost as a modeling algorithm due to its effectiveness.</span>
<span id="cb22-94"><a href="#cb22-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-95"><a href="#cb22-95" aria-hidden="true" tabindex="-1"></a>Before we proceed with the modeling, it’s beneficial to conduct some exploratory data analysis. Specifically, we’re interested in understanding how the **mcsa** (the median weekly cost for school-aged children in childcare centers) has evolved over time.</span>
<span id="cb22-96"><a href="#cb22-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-97"><a href="#cb22-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-100"><a href="#cb22-100" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-101"><a href="#cb22-101" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the lower and upper bounds for outliers</span></span>
<span id="cb22-102"><a href="#cb22-102" aria-hidden="true" tabindex="-1"></a>childcare_costs <span class="sc">|&gt;</span></span>
<span id="cb22-103"><a href="#cb22-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(study_year, mcsa, <span class="at">group =</span> study_year, <span class="at">fill =</span> study_year)) <span class="sc">+</span></span>
<span id="cb22-104"><a href="#cb22-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb22-105"><a href="#cb22-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_distiller</span>(<span class="at">palette =</span> <span class="st">"Blues"</span>)</span>
<span id="cb22-106"><a href="#cb22-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-107"><a href="#cb22-107" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-108"><a href="#cb22-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-109"><a href="#cb22-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-110"><a href="#cb22-110" aria-hidden="true" tabindex="-1"></a>Let us visualize how are childcare costs related to&nbsp;<span class="in">`mhi_2018`</span>&nbsp;(median household income) and&nbsp;<span class="in">`flfpr_20to64`</span>&nbsp;(labor force participation for women).</span>
<span id="cb22-111"><a href="#cb22-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-112"><a href="#cb22-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-115"><a href="#cb22-115" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-116"><a href="#cb22-116" aria-hidden="true" tabindex="-1"></a>childcare_costs <span class="sc">|&gt;</span></span>
<span id="cb22-117"><a href="#cb22-117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(mhi_2018, mcsa, <span class="at">color =</span> flfpr_20to64)) <span class="sc">+</span></span>
<span id="cb22-118"><a href="#cb22-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb22-119"><a href="#cb22-119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb22-120"><a href="#cb22-120" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_color_distiller</span>(<span class="at">palette =</span> <span class="st">"Spectral"</span>)<span class="sc">+</span> <span class="fu">theme_minimal</span>() </span>
<span id="cb22-121"><a href="#cb22-121" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-122"><a href="#cb22-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-123"><a href="#cb22-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-124"><a href="#cb22-124" aria-hidden="true" tabindex="-1"></a>In counties with lower income levels, the cost of childcare is observed to be relatively stable, while in counties with higher income levels, an escalation in childcare costs is noted. Furthermore, a higher prevalence of women participating in the workforce is seen in high-income counties.</span>
<span id="cb22-125"><a href="#cb22-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-126"><a href="#cb22-126" aria-hidden="true" tabindex="-1"></a>Let's check the racial composition of these counties.</span>
<span id="cb22-127"><a href="#cb22-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-128"><a href="#cb22-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-131"><a href="#cb22-131" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-132"><a href="#cb22-132" aria-hidden="true" tabindex="-1"></a>childcare_costs <span class="sc">|&gt;</span></span>
<span id="cb22-133"><a href="#cb22-133" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(mcsa, <span class="fu">starts_with</span>(<span class="st">"one_race"</span>), mhi_2018) <span class="sc">|&gt;</span></span>
<span id="cb22-134"><a href="#cb22-134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>one_race) <span class="sc">|&gt;</span></span>
<span id="cb22-135"><a href="#cb22-135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">starts_with</span>(<span class="st">"one_race"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb22-136"><a href="#cb22-136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(value, mcsa, <span class="at">color =</span> mhi_2018)) <span class="sc">+</span></span>
<span id="cb22-137"><a href="#cb22-137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb22-138"><a href="#cb22-138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(name), <span class="at">scales =</span> <span class="st">"free_x"</span>) <span class="sc">+</span></span>
<span id="cb22-139"><a href="#cb22-139" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_distiller</span>(<span class="at">palette =</span> <span class="st">"Spectral"</span>)<span class="sc">+</span> <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb22-140"><a href="#cb22-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"% of population"</span>)</span>
<span id="cb22-141"><a href="#cb22-141" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-142"><a href="#cb22-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-143"><a href="#cb22-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-144"><a href="#cb22-144" aria-hidden="true" tabindex="-1"></a>In counties with a higher Black population (one_race_b), it is observed that both household income and childcare costs are lower. Conversely, in counties with a higher White population (one_race_w), both household income and childcare costs are seen to be higher. A trend appears to exist in counties with a higher Asian population (one_race_a), where an increase in the Asian population is associated with higher childcare costs. It is important to note that these relationships are not causal, but rather, they are indicative of the intricate interplay between race, socioeconomic class, and geographical location in the U.S.</span>
<span id="cb22-145"><a href="#cb22-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-146"><a href="#cb22-146" aria-hidden="true" tabindex="-1"></a><span class="fu">## Building a model</span></span>
<span id="cb22-147"><a href="#cb22-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-148"><a href="#cb22-148" aria-hidden="true" tabindex="-1"></a>The initiation of our modeling process involves the establishment of our “data budget.” In this instance, the prediction target is mcsa (the costs associated with school-age children in childcare centers), necessitating the removal of other childcare cost measures related to babies, toddlers, and family-based childcare, among others. The FIPS codes, which explicitly encode location, are also to be removed, shifting the focus to county characteristics such as household income and the number of households with children. Given the substantial size of this dataset, it is <span class="co">[</span><span class="ot">suggested</span><span class="co">](https://www.tmwr.org/resampling.html#validation)</span> that a single validation set be utilized.</span>
<span id="cb22-149"><a href="#cb22-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-150"><a href="#cb22-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-153"><a href="#cb22-153" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-154"><a href="#cb22-154" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb22-155"><a href="#cb22-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-156"><a href="#cb22-156" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">111</span>)</span>
<span id="cb22-157"><a href="#cb22-157" aria-hidden="true" tabindex="-1"></a>childcare_split <span class="ot">&lt;-</span> childcare_costs <span class="sc">|&gt;</span></span>
<span id="cb22-158"><a href="#cb22-158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">matches</span>(<span class="st">"^mc_|^mfc"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb22-159"><a href="#cb22-159" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>county_fips_code) <span class="sc">|&gt;</span></span>
<span id="cb22-160"><a href="#cb22-160" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">|&gt;</span></span>
<span id="cb22-161"><a href="#cb22-161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">initial_split</span>(<span class="at">strata =</span> mcsa)</span>
<span id="cb22-162"><a href="#cb22-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-163"><a href="#cb22-163" aria-hidden="true" tabindex="-1"></a>childcare_train <span class="ot">&lt;-</span> <span class="fu">training</span>(childcare_split)</span>
<span id="cb22-164"><a href="#cb22-164" aria-hidden="true" tabindex="-1"></a>childcare_test <span class="ot">&lt;-</span> <span class="fu">testing</span>(childcare_split)</span>
<span id="cb22-165"><a href="#cb22-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-166"><a href="#cb22-166" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">222</span>)</span>
<span id="cb22-167"><a href="#cb22-167" aria-hidden="true" tabindex="-1"></a>childcare_set <span class="ot">&lt;-</span> <span class="fu">validation_split</span>(childcare_train)</span>
<span id="cb22-168"><a href="#cb22-168" aria-hidden="true" tabindex="-1"></a>childcare_set</span>
<span id="cb22-169"><a href="#cb22-169" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-170"><a href="#cb22-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-171"><a href="#cb22-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-172"><a href="#cb22-172" aria-hidden="true" tabindex="-1"></a>Given that all predictors are already in numeric form, there is no requirement for any special feature engineering; a formula such as mcsa \~ … can be utilized. However, there is a need to establish a tunable xgboost model specification with <span class="co">[</span><span class="ot">early stopping</span><span class="co">](https://www.geeksforgeeks.org/regularization-by-early-stopping/)</span>. The number of trees will be maintained as a constant (and not excessively high), the stop_iter (the early stopping parameter) will be set to tune(), and a few other parameters will be tuned. It should be noted that a validation set needs to be established (which in this case is a proportion of the training set) to be reserved for determining when to stop.</span>
<span id="cb22-173"><a href="#cb22-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-174"><a href="#cb22-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-177"><a href="#cb22-177" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-178"><a href="#cb22-178" aria-hidden="true" tabindex="-1"></a>xgb_spec <span class="ot">&lt;-</span></span>
<span id="cb22-179"><a href="#cb22-179" aria-hidden="true" tabindex="-1"></a>  <span class="fu">boost_tree</span>(</span>
<span id="cb22-180"><a href="#cb22-180" aria-hidden="true" tabindex="-1"></a>    <span class="at">trees =</span> <span class="dv">500</span>,</span>
<span id="cb22-181"><a href="#cb22-181" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_n =</span> <span class="fu">tune</span>(),</span>
<span id="cb22-182"><a href="#cb22-182" aria-hidden="true" tabindex="-1"></a>    <span class="at">mtry =</span> <span class="fu">tune</span>(),</span>
<span id="cb22-183"><a href="#cb22-183" aria-hidden="true" tabindex="-1"></a>    <span class="at">stop_iter =</span> <span class="fu">tune</span>(),</span>
<span id="cb22-184"><a href="#cb22-184" aria-hidden="true" tabindex="-1"></a>    <span class="at">learn_rate =</span> <span class="fl">0.01</span></span>
<span id="cb22-185"><a href="#cb22-185" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb22-186"><a href="#cb22-186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"xgboost"</span>, <span class="at">validation =</span> <span class="fl">0.2</span>) <span class="sc">|&gt;</span></span>
<span id="cb22-187"><a href="#cb22-187" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"regression"</span>)</span>
<span id="cb22-188"><a href="#cb22-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-189"><a href="#cb22-189" aria-hidden="true" tabindex="-1"></a>xgb_wf <span class="ot">&lt;-</span> <span class="fu">workflow</span>(mcsa <span class="sc">~</span> ., xgb_spec)</span>
<span id="cb22-190"><a href="#cb22-190" aria-hidden="true" tabindex="-1"></a>xgb_wf</span>
<span id="cb22-191"><a href="#cb22-191" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-192"><a href="#cb22-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-193"><a href="#cb22-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-194"><a href="#cb22-194" aria-hidden="true" tabindex="-1"></a>The model is prepared for deployment. The next step involves adjusting various hyperparameters using the training set, which includes a subset reserved for early stopping, in addition to our validation set.</span>
<span id="cb22-195"><a href="#cb22-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-196"><a href="#cb22-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-199"><a href="#cb22-199" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-200"><a href="#cb22-200" aria-hidden="true" tabindex="-1"></a>doParallel<span class="sc">::</span><span class="fu">registerDoParallel</span>()</span>
<span id="cb22-201"><a href="#cb22-201" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">234</span>)</span>
<span id="cb22-202"><a href="#cb22-202" aria-hidden="true" tabindex="-1"></a>xgb_rs <span class="ot">&lt;-</span> <span class="fu">tune_grid</span>(xgb_wf, childcare_set, <span class="at">grid =</span> <span class="dv">15</span>)</span>
<span id="cb22-203"><a href="#cb22-203" aria-hidden="true" tabindex="-1"></a>xgb_rs</span>
<span id="cb22-204"><a href="#cb22-204" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-205"><a href="#cb22-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-206"><a href="#cb22-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-207"><a href="#cb22-207" aria-hidden="true" tabindex="-1"></a><span class="fu">## Evaluating results </span></span>
<span id="cb22-208"><a href="#cb22-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-209"><a href="#cb22-209" aria-hidden="true" tabindex="-1"></a>Let's see how this turned out.</span>
<span id="cb22-210"><a href="#cb22-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-211"><a href="#cb22-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-214"><a href="#cb22-214" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-215"><a href="#cb22-215" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(xgb_rs)</span>
<span id="cb22-216"><a href="#cb22-216" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-217"><a href="#cb22-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-218"><a href="#cb22-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-219"><a href="#cb22-219" aria-hidden="true" tabindex="-1"></a>Visualizing the top results</span>
<span id="cb22-220"><a href="#cb22-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-221"><a href="#cb22-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-224"><a href="#cb22-224" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-225"><a href="#cb22-225" aria-hidden="true" tabindex="-1"></a><span class="fu">show_best</span>(xgb_rs, <span class="st">"rmse"</span>)</span>
<span id="cb22-226"><a href="#cb22-226" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-227"><a href="#cb22-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-228"><a href="#cb22-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-229"><a href="#cb22-229" aria-hidden="true" tabindex="-1"></a>The optimal Root Mean Square Error (RMSE) is slightly over \$20. This value provides an estimate of the accuracy with which we can predict the median childcare cost in a US county, given that the median cost in this dataset was approximately \$100.</span>
<span id="cb22-230"><a href="#cb22-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-231"><a href="#cb22-231" aria-hidden="true" tabindex="-1"></a>We will now employ the **`last_fit()`** function to fit the model one last time using the training data and evaluate its performance on the test data, utilizing the numerically optimal result obtained from **`xgb_rs`**.</span>
<span id="cb22-232"><a href="#cb22-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-233"><a href="#cb22-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-236"><a href="#cb22-236" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-237"><a href="#cb22-237" aria-hidden="true" tabindex="-1"></a>childcare_fit <span class="ot">&lt;-</span> xgb_wf <span class="sc">|&gt;</span></span>
<span id="cb22-238"><a href="#cb22-238" aria-hidden="true" tabindex="-1"></a>  <span class="fu">finalize_workflow</span>(<span class="fu">select_best</span>(xgb_rs, <span class="st">"rmse"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb22-239"><a href="#cb22-239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">last_fit</span>(childcare_split)</span>
<span id="cb22-240"><a href="#cb22-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-241"><a href="#cb22-241" aria-hidden="true" tabindex="-1"></a>childcare_fit</span>
<span id="cb22-242"><a href="#cb22-242" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-243"><a href="#cb22-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-244"><a href="#cb22-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-245"><a href="#cb22-245" aria-hidden="true" tabindex="-1"></a>Let's see how did this model perform on the testing data, that was not used in tuning or training.</span>
<span id="cb22-246"><a href="#cb22-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-247"><a href="#cb22-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-250"><a href="#cb22-250" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-251"><a href="#cb22-251" aria-hidden="true" tabindex="-1"></a><span class="fu">collect_metrics</span>(childcare_fit)</span>
<span id="cb22-252"><a href="#cb22-252" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-253"><a href="#cb22-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-254"><a href="#cb22-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-255"><a href="#cb22-255" aria-hidden="true" tabindex="-1"></a>Most important features for the target variable in this xgboost model.</span>
<span id="cb22-256"><a href="#cb22-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-257"><a href="#cb22-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-260"><a href="#cb22-260" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-261"><a href="#cb22-261" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vip)</span>
<span id="cb22-262"><a href="#cb22-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-263"><a href="#cb22-263" aria-hidden="true" tabindex="-1"></a><span class="fu">extract_workflow</span>(childcare_fit) <span class="sc">|&gt;</span></span>
<span id="cb22-264"><a href="#cb22-264" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_fit_parsnip</span>() <span class="sc">|&gt;</span></span>
<span id="cb22-265"><a href="#cb22-265" aria-hidden="true" tabindex="-1"></a>  <span class="fu">vip</span>(<span class="at">num_features =</span> <span class="dv">15</span>, <span class="at">geom =</span> <span class="st">"point"</span>)</span>
<span id="cb22-266"><a href="#cb22-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-267"><a href="#cb22-267" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-268"><a href="#cb22-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-269"><a href="#cb22-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-270"><a href="#cb22-270" aria-hidden="true" tabindex="-1"></a>In this model, significant influences are exerted by the percentage of the county’s population identified as Asian, the median income of households, the median earnings for women, the year, and the total number of households in the county.</span>
<span id="cb22-271"><a href="#cb22-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-272"><a href="#cb22-272" aria-hidden="true" tabindex="-1"></a><span class="fu">## Deploying the model</span></span>
<span id="cb22-273"><a href="#cb22-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-274"><a href="#cb22-274" aria-hidden="true" tabindex="-1"></a>Object created for deploying the model.</span>
<span id="cb22-275"><a href="#cb22-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-276"><a href="#cb22-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-279"><a href="#cb22-279" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-280"><a href="#cb22-280" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vetiver)</span>
<span id="cb22-281"><a href="#cb22-281" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">extract_workflow</span>(childcare_fit) <span class="sc">|&gt;</span></span>
<span id="cb22-282"><a href="#cb22-282" aria-hidden="true" tabindex="-1"></a>  <span class="fu">vetiver_model</span>(<span class="st">"childcare-costs-xgb"</span>)</span>
<span id="cb22-283"><a href="#cb22-283" aria-hidden="true" tabindex="-1"></a>v</span>
<span id="cb22-284"><a href="#cb22-284" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Made with <a href="https://quarto.org/">Quarto</a></div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right"><a href="mailto:jayjit11031@gmail.com">Contact Jayjit Das</a></div>
  </div>
</footer>



</body></html>